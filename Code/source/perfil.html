<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfil</title>

    <link rel="stylesheet" href="./assets/css/fonts.css">
    <link rel="stylesheet" href="./assets/css/reset.css">
    <link rel="stylesheet" href="./assets/css/header.css">
    <link rel="stylesheet" href="./assets/css/perfil.css">
    <link rel="stylesheet" href="./assets/css/popupLoginRegistro.css">
</head>

<body>
    <header>
        <div class="container">
            <div class="navbar">
                <div class="logo">
                    <img src="./assets/img/logo.png" alt="Logo" width="60px" height="60px">
                    <p class="LogoName">ARTSYPAGES</p>
                </div>
                <nav>
                    <ul id="menuItems" height="200px">
                        <li><a href="#">Faq</a></li>
                        <li><a href="./explorar.html">Explorar</a></li>
                        <li><a href="./forum.html">Fórum</a></li>
                        <li><button id="buttonLogin">Login</button></li>
                        <li><button id="buttonCriar">Criar</button></li>>
                    </ul>
                </nav>
                <img src="./assets/img/perfil.png" alt="Perfil" width="30px" class="perfil">
                <img src="./assets/img/menuHam.png" alt="Menu" width="50px" class="menu_icon">
            </div>
        </div>
    </header>



    <!-- Pop Up Login -->

    <dialog id="poplogin">


        <main id="pop_login">


            <!-- Imagem -->
            <section>

                <img src="./assets/img/img-login.png" class="img-login">

            </section>
            <!-- Login e Senha -->
            <section>
                <form id="loginForm">
                    <fieldset class="login">
                        <legend class="login-titulo">LOGIN</legend>
                        <input type="email" name="login" id="username" placeholder="Email" required> <br>

                        <input type="password" name="senha" id="password" placeholder="Senha" required><br>

                        <input type="submit" value="LOGIN" class="login-btn">

                    </fieldset>
                    <!-- Registre -->
                    <div class="registro-login">
                        <a href="#">Registre-se </a>
                    </div>


                </form>


            </section>
            <section>
                <button id="btn-close">X</button>
            </section>



        </main>


    </dialog>

    <!-- Pop Up Registro-->

    <dialog id="popRegistro">

        <main id="pop_registro">
            <!-- Imagem -->
            <section>
                <img src="./assets/img/img4.png" class="img4">
            </section>

            <!-- Formulario Registro -->

            <section>
                <form>
                    <fieldset class="registro">
                        <legend class="registro-titulo">Register</legend>
                        <input type="email" name="login" class="email-registro" placeholder="Email" required> <br>
                        <input type="text" name="senha" class="senha-registro" placeholder="Senha" required><br>
                        <input type="date" name="data" class="data-registro " placeholder="Data de Nascimento"
                            required><br>
                        <input type="number" name="numero" class="numero-registro " placeholder="Numero de Telefone"
                            required><br>
                        <input type="submit" value="register" class="registro-btn">

                    </fieldset>


                </form>
            </section>

            <!-- Botâo para fechar popup -->
            <section>
                <button id="btn-close-registro">X</button>
            </section>
        </main>


    </dialog>



    <div class="perfil">
        <div class="editavel">
            <div class="header-perfil" onclick="handleBrowseClick('input-image-hidden');">
                <img src="./assets/img/BlankPFP.webp" alt="Profile Picture" class="ProfilePicture" id="output">
                <h3 id="profileName">Legolas</h3>
                <input style="display:none" type="file" accept="image/*" id="input-image-hidden">
            </div>
            <div class="texto">
                <h4 class="bio" id="profileBio">Lorem ipsum dolor sit amet consectetur adipisicing elit. Id dolore
                    reprehenderit ipsum in nam officia deserunt alias, veniam saepe quas tenetur cumque ullam aperiam
                    placeat possimus. Ratione fugiat est placeat.</h4>
            </div>
            <button id="saveChangesBtn" style="display:none;">Save Changes</button>
            <div class="div-social">

                <div class="linksSocial">
                    <a href="">
                        <div class="btnSocial">
                            <img src="./assets/img/Insta.png" alt="instagram icon" width="50px">
                            <p>INSTAGRAM</p>
                        </div>
                    </a>
                </div>
                <div class="linksSocial">
                    <a href="">
                        <div class="btnSocial">
                            <img src="./assets/img/Linkedin.png" alt="Linkedin icon" width="50px">
                            <p>LINKEDIN</p>
                        </div>
                    </a>
                </div>
                <div class="linksSocial">
                    <a href="">
                        <div class="btnSocial">
                            <img src="./assets/img/Youtube.png" alt="youtube icon" width="50px">
                            <p>YOUTUBE</p>
                        </div>
                    </a>
                </div>
            </div>
        </div>

        <script>
            var menuItems = document.getElementById("menuItems");
            menuItems.style.maxHeight = "0px";
            function menu() {
                if (menuItems.style.maxHeight == "0px") {
                    menuItems.style.maxHeight = "200px";
                } else {
                    menuItems.style.maxHeight = "0px";
                }
            }

            // Função para abrir a janela de seleção de arquivo quando a imagem do banner é clicada
            document.getElementById('imagem').addEventListener('click', function () {
                document.getElementById('inputImage').click();
            });

            // Função para exibir a nova imagem selecionada do banner e salvá-la no localStorage
            document.getElementById('inputImage').addEventListener('change', function () {
                const file = this.files[0];
                const reader = new FileReader();

                reader.onload = function (e) {
                    const imgData = e.target.result;
                    document.getElementById('imagem').src = imgData;
                    localStorage.setItem('bannerImage', imgData); // Salva a imagem do banner no localStorage
                }

                reader.readAsDataURL(file);
            });

            // Função para abrir a janela de seleção de arquivo quando a imagem do perfil é clicada
            document.getElementById('output').addEventListener('click', function (event) {
                document.getElementById('input-image-hidden').click();
                event.stopPropagation();
            });

            // Função para exibir a nova imagem selecionada do perfil e salvá-la no localStorage
            document.getElementById('input-image-hidden').addEventListener('change', function () {
                const file = this.files[0];
                const reader = new FileReader();

                reader.onload = function (e) {
                    const imgData = e.target.result;
                    document.getElementById('output').src = imgData;
                    localStorage.setItem('profileImage', imgData); // Salva a imagem do perfil no localStorage
                }

                reader.readAsDataURL(file);
            });

            // Função para carregar a imagem do banner e do perfil do localStorage ao carregar a página
            window.onload = function () {
                const savedBannerImage = localStorage.getItem('bannerImage');
                if (savedBannerImage) {
                    document.getElementById('imagem').src = savedBannerImage;
                }

                const savedProfileImage = localStorage.getItem('profileImage');
                if (savedProfileImage) {
                    document.getElementById('output').src = savedProfileImage;
                }

                const savedProfileName = localStorage.getItem('profileName');
                if (savedProfileName) {
                    document.getElementById('profileName').textContent = savedProfileName;
                }

                const savedProfileBio = localStorage.getItem('profileBio');
                if (savedProfileBio) {
                    document.getElementById('profileBio').textContent = savedProfileBio;
                }
            }

            // Função para permitir a edição do nome e da bio
            document.getElementById('profileName').addEventListener('click', function (event) {
                const nameElement = document.getElementById('profileName');
                const currentName = nameElement.textContent;
                const nameInput = document.createElement('input');
                nameInput.type = 'text';
                nameInput.value = currentName;
                nameInput.id = 'nameInput';
                nameElement.replaceWith(nameInput);
                document.getElementById('saveChangesBtn').style.display = 'block';
                event.stopPropagation();
            });

            document.getElementById('profileBio').addEventListener('click', function (event) {
                const bioElement = document.getElementById('profileBio');
                const currentBio = bioElement.textContent;
                const bioInput = document.createElement('textarea');
                bioInput.value = currentBio;
                bioInput.id = 'bioInput';
                bioElement.replaceWith(bioInput);
                document.getElementById('saveChangesBtn').style.display = 'block';
                event.stopPropagation();
            });

            document.getElementById('saveChangesBtn').addEventListener('click', function () {
                const nameInput = document.getElementById('nameInput');
                const bioInput = document.getElementById('bioInput');

                if (nameInput) {
                    const newName = nameInput.value;
                    const nameElement = document.createElement('h3');
                    nameElement.id = 'profileName';
                    nameElement.textContent = newName;
                    nameInput.replaceWith(nameElement);
                    localStorage.setItem('profileName', newName);
                }

                if (bioInput) {
                    const newBio = bioInput.value;
                    const bioElement = document.createElement('h4');
                    bioElement.className = 'bio';
                    bioElement.id = 'profileBio';
                    bioElement.textContent = newBio;
                    bioInput.replaceWith(bioElement);
                    localStorage.setItem('profileBio', newBio);
                }

                document.getElementById('saveChangesBtn').style.display = 'none';

                // Re-attach the event listeners to the new elements
                document.getElementById('profileName').addEventListener('click', function (event) {
                    const nameElement = document.getElementById('profileName');
                    const currentName = nameElement.textContent;
                    const nameInput = document.createElement('input');
                    nameInput.type = 'text';
                    nameInput.value = currentName;
                    nameInput.id = 'nameInput';
                    nameElement.replaceWith(nameInput);
                    document.getElementById('saveChangesBtn').style.display = 'block';
                    event.stopPropagation();
                });

                document.getElementById('profileBio').addEventListener('click', function (event) {
                    const bioElement = document.getElementById('profileBio');
                    const currentBio = bioElement.textContent;
                    const bioInput = document.createElement('textarea');
                    bioInput.value = currentBio;
                    bioInput.id = 'bioInput';
                    bioElement.replaceWith(bioInput);
                    document.getElementById('saveChangesBtn').style.display = 'block';
                    event.stopPropagation();
                });
            });
        </script>
        <script src="scripts/perfil.js"></script>
        <script src="scripts/popupLoginRegistro.js"></script>

</body>

</html>
